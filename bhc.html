<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta name="generator" content="jemdoc, see http://jemdoc.jaboc.net/" />
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link rel="stylesheet" href="css/mysite.css" type="text/css" />
<link rel="stylesheet" href="css/bibtex.css" type="text/css" />
<title>Blind X-ray CT Image Reconstruction from Polychromatic Measurements</title>
<!-- MathJax -->
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<!-- End MathJax -->
<script type="text/javascript">
<!--
// Toggle Display of BibTeX
function toggleBibtex(articleid) {
	var bib = document.getElementById('bib_'+articleid);
	if (bib) {
		if(bib.className.indexOf('bibtex') != -1) {
		bib.className.indexOf('noshow') == -1?bib.className = 'bibtex noshow':bib.className = 'bibtex';
		}
	} else {
		return;
	}
}
-->
</script>
</head>
<body>
<table summary="Table for page layout." id="tlayout">
<tr valign="top">
<td id="layout-menu">
<div class="menu-item"><a href="bhc.html" class="current">Beam&nbsp;Hardening&nbsp;Correction</a></div>
<div class="menu-item"><a href="npg.html">Projected&nbsp;NPG</a></div>
</td>
<td id="layout-content">
<h1>Blind X-ray CT Image Reconstruction from Polychromatic Measurements</h1>
<p><a href="http://home.eng.iastate.edu/~renliang" target=&ldquo;blank&rdquo;>Renliang Gu</a>
and <a href="http://home.eng.iastate.edu/~ald" target=&ldquo;blank&rdquo;>Aleksandar Dogandžić</a></p>
<div class="preamble noshow">
\(
\newcommand{\b}[1]{{\boldsymbol{#1}}}
\newcommand{\bm}[1]{{\boldsymbol{#1}}}
\newcommand{\cI}{\mathcal{I}}
\newcommand{\dif}{\rm d}
\newcommand{\balpha}{\b{\alpha}}
\newcommand{\bcI}{\b{\mathcal{I}}}
\)
</div>
<h3>Summary</h3>
<p>We propose a method for sparse image reconstruction from polychromatic
computed tomography (CT) measurements under the blind scenario where the
material of the inspected object and the incident-energy spectrum are
unknown.  Our framework is general and applies for both the Poisson and lognormal noise assumption.</p>
<p>This is the first model that expresses noiseless CT measurements in a form
of Laplace transform. This new representation may open a new gate to handle
the beam hardening artifacts and lead to a new framework for signal
reconstruction and material characterization from polychromatic
measurements.</p>
<p>In many scenarios, knowing the incident spectrum and the inspected material
may be challenging.  Our method, requiring <i>no more</i> information than the
conventional FBP method, simplifies the beam hardening correction and
extends the usage to the scenarios where X-ray spectrum or material to
inspect is unknown.</p>
<div class="infoblock">
<div class="blockcontent">
<p>This work is supported by the National Science Foundation under 
<a href="http://www.nsf.gov/awardsearch/showAward?AWD_ID=1421480&amp;HistoricalAwards=false" target=&ldquo;blank&rdquo;>Grant CCF-1421480</a>.</p>
</div></div>
<h3>Illustration of our Iterative NPG-BFGS Method</h3>
<table class="imgtable"><tr><td>
<img src="fig/castingAnim.gif" alt="iterative algorithm animation" width="700px" />&nbsp;</td>
<td align="left"></td></tr></table>
<p>Estimated \(\balpha\) and \(-\ln\bigl(\b{b}^\text{L}(\cdot)\bcI\bigr)\) from 360 fanbeam
real X-ray CT projections.</p>
<div class="infoblock">
<div class="blockcontent">
<p>Real X-ray CT data: courtesy of Dr.&nbsp;Joseph N.&nbsp;Gray, Center for 
Nondestructive Evaluation, Iowa State University.</p>
</div></div>
<h3>Background</h3>
<p>According to the Lambert-Beer's law, the fraction \(\dif \cI / \cI\) of plane 
wave intensity lost in traversing an infinitesimal thickness \(\dif\ell\) at 
Cartesian coordinates \((x,y)\) is proportional to \(\dif\ell\), so that</p>
<p style="text-align:center">
\[
    \begin{equation}
        \frac{\dif \cI}{\cI} = - \mu(\varepsilon) \alpha(x,y) \dif\ell.
        \label{eq:beerLaw1}
    \end{equation}
\]
</p><p>where</p>
<ul>
<li><p>\(\mu(\varepsilon)\) is the <i>mass attenuation coefficient</i> of the 
material (in cm\(^2/\)g), which depends only on the photon energy 
\(\varepsilon\),</p>
</li>
<li><p>\(\alpha(x,y)\) is the density map of the inspected object (in \(\text{g}/\text{cm}^3\)).</p>
</li>
</ul>
<p>Therefore, a monochromatic X-ray signal at photon energy \(\varepsilon\) 
attenuates <i>exponentially</i> as it penetrates an object composed of a single 
material:</p>
<p style="text-align:center">
\[
    \begin{equation}
        \cI^{\text{out}} = \cI^{\text{in}}  \exp\Bigl[ - 
        \mu(\varepsilon) \int_\ell \alpha(x,y) \dif\ell\Bigr].
        \label{eq:monotoneModel}
    \end{equation}
\]
</p><p>where \(\cI^{\text{out}}\) and \(\cI^{\text{in}}\) are the emergent 
and incident X-ray signal energies, respectively.</p>
<p>However, X-rays generated by vacuum tubes are not monochromatic.  To 
describe the polychromatic X-ray source, assume that its incident 
intensity \(\cI^{\text{in}}\) spreads along photon energy \(\varepsilon\) 
following the density \(\iota(\varepsilon)\), i.e.,</p>
<p style="text-align:center">
\[
    \begin{equation}
        \label{eq:constanttotalenergy}
        \int \iota(\varepsilon) \dif\varepsilon = \cI^{\text{in}}.
    \end{equation}
\]
</p><p>Then, the noiseless measurement collected by an energy integral
detector upon traversing a straight line \(\ell=\ell(x,y)\) is</p>
<p style="text-align:center">
\[
    \begin{equation}
        \cI^{\text{out}}=\int \iota(\varepsilon) \,
        \exp\Big[- \mu(\varepsilon) \, \int_\ell \alpha(x,y) \, \dif\ell\Big] \, 
        \dif\varepsilon.
        \label{eq:polyModel0}
    \end{equation}
\]
</p><h3>Main Idea</h3>
<table class="imgtable"><tr><td>
<img src="fig/triRelate.png" alt="triRelate" width="400px" />&nbsp;</td>
<td align="left"><p><b>Assumption:</b></p>
<ul>
<li><p>Both incident spectrum \(\iota(\varepsilon)\) and mass attenuation
function \(\kappa(\varepsilon)\) of the object are <i>unknown</i>.</p>
</li>
</ul>
<p><b>Objective:</b></p>
<ul>
<li><p>Estimate the density map \(\alpha(x,y)\).</p>
</li>
</ul>
<p>Based on the fact that mass attenuation \(\kappa(\varepsilon)\) and incident spectrum density \(\iota(\varepsilon)\) are both functions of \(\varepsilon\), our <b>idea</b> is to:</p>
<ul>
<li><p>write the model as integrals of \(\kappa\) rather than \(\varepsilon\);</p>
</li>
<li><p>estimate \(\iota(\varepsilon(\kappa)) |\varepsilon'(\kappa)|\) rather than \(\iota(\varepsilon)\) and \(\kappa(\varepsilon)\).</p>
</li>
</ul>
<p>For invertible \(\kappa(\varepsilon)\), define its inverse as 
\(\varepsilon(\kappa)\) and</p>
</td></tr></table>
<p style="text-align:center">
\[
    \begin{align}
        \mathcal{I}^{\mathrm{in}} &amp;= \int \iota(\varepsilon(\kappa)) 
        |\varepsilon&rsquo;(\kappa)| d\kappa,\\
        \mathcal{I}^{\mathrm{out}} &amp;= \int \iota(\varepsilon(\kappa)) 
        |\varepsilon&rsquo;(\kappa)|
        \exp\Bigl[ -\kappa \int_\ell \alpha(x,y)  d\ell\Bigr] d\kappa
    \end{align}
\]
</p><h3>Download</h3>
<p>Clone or press “Download ZIP” button in the right panel of
<a href="https://github.com/isucsp/imgRecSrc" target=&ldquo;blank&rdquo;>imgRecSrc's GitHub page</a>.</p>
<h3>Usage</h3>
<div class="codeblock">
<div class="blocktitle">Matlab command to start the reconstruction:</div>
<div class="blockcontent"><pre>
opt.E=20; opt.maxItr=2e3; opt.thresh=1e-6; opt.u=1e-5;
output=beamhardenSpline(Phi,Phit,Psi,Psit,y,initSig,opt);
</pre></div></div>
<p>where <tt>Phi</tt> and <tt>Phit</tt> are the function handles that implement the forward
and backward 2D X-ray CT projections, <tt>Psi</tt> and <tt>Psit</tt> are the function
handles for inverse discrete wavelet transform (DWT) and DWT, and <tt>initSig</tt>
is the initialization for the iterative algorithm.
<tt>y=-ln(Imea(:)/max(Imea(:)))</tt> where <tt>Imea</tt> is a matrix of size \(N\times p\)
for the 2D X-ray CT measurements.  Here, \(N\) is the number of sampling
points for each projection and \(p\) is the number of projections.
<tt>initSig</tt> is usually set to the FBP reconstruction from <tt>y</tt>.  </p>
<p>The <tt>output</tt> will be a structure bearing everything that is needed; see
the <a href="https://github.com/isucsp/imgRecSrc/blob/master/bhc/beamhardenSpline.m" target=&ldquo;blank&rdquo;><tt>beamhardenSpline</tt> source code</a> for detail.</p>
<p>The default regularization method, <tt>opt.proximal='wvltADMM'</tt>, we use here
is the nonnegativity and the \(\ell_1\)-norm of the wavelet coefficients of
the image.  However, setting <tt>opt.proximal</tt> to <tt>'nonneg'</tt> switches the
algorithm to use only the nonnegativity constraints only.  Other options
such as <tt>opt.proximal='tviso'</tt> and <tt>opt.proximal='tvl1'</tt> employs the
nonnegativity and total-variation (TV) regularization.</p>
<p>Note that in the cases other than <tt>opt.proximal='wvltADMM'</tt>, <tt>Psi</tt> and
<tt>Psit</tt> can be set to <tt>[]</tt>.  For <tt>opt.proximal='nonneg'</tt>, the algorithm 
is basically a maximum likelihood algorithm.  So, setting smaller number of 
iterations limit, e.g., 500, gives fast and decent solution.</p>
<h3>Reference:</h3>
<ul>
<li><p>R.&nbsp;Gu and A.&nbsp;Dogandžić, &ldquo;Blind X-ray CT Image Reconstruction from
Polychromatic Poisson Measurements,&rdquo; <i>IEEE Trans. Comput. Imag.</i>, vol.&nbsp;2, 
no.&nbsp;2, pp.&nbsp;150&ndash;165, 2016.
<a href="javascript:toggleBibtex('gd16beamharden')">[BibTex]</a> 
<a href="http://dx.doi.org/10.1109/TCI.2016.2523431" target=&ldquo;blank&rdquo;>[DOI]</a>
<a href="pdf/beamhardenDouble.pdf">[PDF]</a>
<a href="http://www.sigport.org/668" target=&ldquo;blank&rdquo;>[Poster]</a></p>
</li>
</ul>
<div id="bib_gdqnde14" class="bibtex noshow"><pre>
@STRING{IEEE_J_CI        = "{IEEE} Trans. Comput. Imag."}
@article{gd16beamharden,
  Author = {Renliang Gu and Aleksandar Dogand\v{z}i\'c},
  Journal = IEEE_J_CI,
  Title = {Blind {X}-ray {CT} Image Reconstruction from Polychromatic 
    {P}oisson Measurements},
  volume={2},
  number={2},
  pages={150-165},
  doi={10.1109/tci.2016.2523431},
  Year = 2016
}
</pre></div>
<ul>
<li><p>R.&nbsp;Gu and A.&nbsp;Dogandžić, (Sep.&nbsp;2015). Polychromatic X-ray CT image 
reconstruction and mass-attenuation spectrum estimation. arXiv: 
<a href="http://arxiv.org/abs/1509.02193" target=&ldquo;blank&rdquo;>1509.02193</a> [stat.ME].
<a href="http://www.slideshare.net/AleksandarDogandi/blind-beamhardening-correction-from-poisson-measurements" target=&ldquo;blank&rdquo;>[slides]</a></p>
</li>
</ul>
<ul>
<li><p>R.&nbsp;Gu and A.&nbsp;Dogandžić, “Polychromatic sparse image reconstruction and 
mass attenuation spectrum estimation via B-spline basis function 
expansion,” in <i>Rev. Prog. Quant.  Nondestr. Eval.</i>, D.&nbsp;E.&nbsp;Chimenti and 
L.&nbsp;J.&nbsp;Bond, Eds., ser. AIP Conf. Proc. Vol.&nbsp;34 1650, Melville, NY, 2015, 
pp.&nbsp;1707–1716.
(This paper is on the <b>lognormal</b> measurement model with \(\ell_1\)-norm
regularizations)
<a href="javascript:toggleBibtex('gdqnde14')">[BibTex]</a> 
<a href="http://dx.doi.org/10.1063/1.4914792" target=&ldquo;blank&rdquo;>[DOI]</a> <a href="pdf/qnde2014.pdf">[PDF]</a></p>
</li>
</ul>
<div id="bib_gdqnde14" class="bibtex noshow"><pre>
@string{qnde = { {Rev. Prog. Quant. Nondestr. Eval.} } }
@inproceedings{gdqnde14,
    Address = {Melville, {NY}},
    Author = {Gu, Renliang and  Dogand\v{z}i\'c, Aleksandar},
    Booktitle = QNDE,
    Series = {AIP Conf. Proc.},
    Editor = {Dale E. Chimenti  and Leonard J. Bond},
    Title = {Polychromatic Sparse Image Reconstruction and Mass 
        Attenuation Spectrum Estimation via {B}-Spline Basis Function 
            Expansion},
    volume={34 1650},
    Year = {2015},
    pages={1707-1716}
}
</pre></div>
<ul>
<li><p>R.&nbsp;Gu and A.&nbsp;Dogandžić, “Beam hardening correction via mass attenuation 
discretization,” in <i>Proc. IEEE Int. Conf. Acoust., Speech, Signal 
Process.</i>, Vancouver, Canada, May 2013, pp.&nbsp;1085–1089.  
<a href="javascript:toggleBibtex('GuDogandzic2013')">[BibTeX]</a> 
<a href="http://dx.doi.org/10.1109/ICASSP.2013.6637817" target=&ldquo;blank&rdquo;>[DOI]</a> 
<a href="pdf/icassp2013.pdf">[PDF]</a> <a href="pdf/icassp2013poster.pdf">[poster]</a></p>
</li>
</ul>
<div id="bib_GuDogandzic2013" class="bibtex noshow"><pre>
@string{icassp = { {Proc. IEEE Int. Conf. Acoust., Speech, Signal Process.} } }
@conference{GuDogandzic2013,
    title ={Beam Hardening Correction Via Mass Attenuation Discretization},
    booktitle = ICASSP,
    author  = {Gu, Renliang and  Dogand\v{z}i\'c, Aleksandar},
    Address = {Vancouver, Canada},
    Month = may,
    pages={1085-1089},
    year    = 2013
}
</pre></div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-71579362-1', 'auto');
  ga('send', 'pageview');
</script>
<div id="footer">
<div id="footer-text">
Page upadted on 2016-06-02
</div>
</div>
</td>
</tr>
</table>
</body>
</html>
